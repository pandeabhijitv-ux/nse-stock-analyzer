<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSE Stock Analyzer - Indian Market</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        #root {
            max-width: 400px;
            margin: 0 auto;
            background: #f5f5f5;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.3);
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        .sectors {
            padding: 15px;
        }
        .sector-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            border-left: 4px solid;
        }
        .sector-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .sector-card h3 {
            font-size: 18px;
            margin-bottom: 5px;
            color: #333;
        }
        .sector-card p {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
        }
        .stock-count {
            display: inline-block;
            background: #f0f0f0;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            color: #666;
        }
        .stock-list {
            padding: 15px;
        }
        .stock-item {
            background: white;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        .stock-item:hover {
            transform: translateX(5px);
        }
        .stock-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .stock-symbol {
            font-size: 16px;
            font-weight: bold;
            color: #333;
        }
        .stock-score {
            font-size: 18px;
            font-weight: bold;
            padding: 4px 12px;
            border-radius: 8px;
            color: white;
        }
        .score-high { background: #22c55e; }
        .score-medium { background: #f59e0b; }
        .score-low { background: #ef4444; }
        .stock-name {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }
        .stock-price {
            font-size: 14px;
            color: #333;
        }
        .back-button {
            background: white;
            border: none;
            padding: 10px 15px;
            margin: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }
        .back-button:hover {
            background: #f0f0f0;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }
        .stock-detail {
            padding: 15px;
        }
        .detail-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .recommendation {
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
            color: white;
        }
        .recommendation.buy { background: #22c55e; }
        .recommendation.hold { background: #f59e0b; }
        .recommendation.sell { background: #ef4444; }
        .metric-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .metric-row:last-child {
            border-bottom: none;
        }
        .metric-label {
            color: #666;
            font-size: 14px;
        }
        .metric-value {
            color: #333;
            font-weight: 600;
            font-size: 14px;
        }
        .tabs {
            display: flex;
            background: #f0f0f0;
            border-radius: 8px;
            padding: 4px;
            margin: 15px;
        }
        .tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
        }
        .tab.active {
            background: #667eea;
            color: white;
        }
        .options-badge {
            display: inline-block;
            background: #22c55e;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
            margin-left: 5px;
        }
        .options-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .options-header {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            color: white;
            font-weight: bold;
        }
        .options-header.bullish {
            background: #22c55e;
        }
        .options-header.bearish {
            background: #ef4444;
        }
        .options-header.neutral {
            background: #f59e0b;
        }
        .strike-option {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .strike-option.recommended {
            border: 2px solid #22c55e;
            background: #f0fdf4;
        }
        .strike-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .strike-label {
            font-size: 13px;
            font-weight: 600;
            color: #333;
        }
        .strike-price {
            font-size: 16px;
            font-weight: bold;
            color: #667eea;
        }
        .premium-row {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            font-size: 12px;
        }
        .greek-item {
            background: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .greek-name {
            font-size: 13px;
            font-weight: 600;
            color: #666;
        }
        .greek-value {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
            margin: 5px 0;
        }
        .greek-desc {
            font-size: 11px;
            color: #999;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Indian NSE Sectors and Stocks
        const SECTORS = {
            Technology: ['TCS', 'INFY', 'WIPRO', 'HCLTECH', 'TECHM', 'LTI', 'COFORGE', 'MINDTREE', 'MPHASIS', 'PERSISTENT'],
            Banking: ['HDFCBANK', 'ICICIBANK', 'SBIN', 'KOTAKBANK', 'AXISBANK', 'INDUSINDBK', 'BANKBARODA', 'PNB', 'FEDERALBNK', 'IDFCFIRSTB'],
            'Financial Services': ['BAJFINANCE', 'BAJAJFINSV', 'HDFCLIFE', 'SBILIFE', 'ICICIGI', 'HDFCAMC', 'MUTHOOTFIN', 'CHOLAFIN', 'M&MFIN', 'PFC'],
            FMCG: ['HINDUNILVR', 'ITC', 'NESTLEIND', 'BRITANNIA', 'DABUR', 'MARICO', 'GODREJCP', 'COLPAL', 'TATACONSUM', 'EMAMILTD'],
            Automobile: ['MARUTI', 'TATAMOTORS', 'M&M', 'BAJAJ-AUTO', 'EICHERMOT', 'HEROMOTOCO', 'ASHOKLEY', 'TVSMOTOR', 'BALKRISIND', 'MRF'],
            Pharma: ['SUNPHARMA', 'DRREDDY', 'CIPLA', 'DIVISLAB', 'AUROPHARMA', 'LUPIN', 'BIOCON', 'TORNTPHARM', 'ALKEM', 'CADILAHC'],
            Energy: ['RELIANCE', 'ONGC', 'IOC', 'BPCL', 'HINDPETRO', 'GAIL', 'COALINDIA', 'ADANIGREEN', 'ADANIPOWER', 'TATAPOWER'],
            'Metals & Mining': ['TATASTEEL', 'HINDALCO', 'JSWSTEEL', 'VEDL', 'SAIL', 'JINDALSTEL', 'NMDC', 'HINDZINC', 'NATIONALUM', 'APLAPOLLO'],
            Infrastructure: ['LT', 'ULTRACEMCO', 'GRASIM', 'ADANIPORTS', 'HINDCOPPER', 'RAMCOCEM', 'SHREECEM', 'AMBUJACEM', 'ACC', 'CONCOR'],
            'Consumer Durables': ['TITAN', 'HAVELLS', 'VOLTAS', 'WHIRLPOOL', 'CROMPTON', 'BATAINDIA', 'SYMPHONY', 'BLUESTARCO', 'RAJESHEXPO', 'KAJARIACER']
        };

        const SECTOR_COLORS = {
            Technology: '#3b82f6',
            Banking: '#10b981',
            'Financial Services': '#8b5cf6',
            FMCG: '#f59e0b',
            Automobile: '#ef4444',
            Pharma: '#06b6d4',
            Energy: '#ec4899',
            'Metals & Mining': '#14b8a6',
            Infrastructure: '#f97316',
            'Consumer Durables': '#6366f1'
        };

        // Stock name mapping for better display
        const STOCK_NAMES = {
            TCS: 'Tata Consultancy Services',
            INFY: 'Infosys Ltd',
            WIPRO: 'Wipro Ltd',
            HCLTECH: 'HCL Technologies',
            TECHM: 'Tech Mahindra',
            HDFCBANK: 'HDFC Bank',
            ICICIBANK: 'ICICI Bank',
            SBIN: 'State Bank of India',
            KOTAKBANK: 'Kotak Mahindra Bank',
            AXISBANK: 'Axis Bank',
            BAJFINANCE: 'Bajaj Finance',
            BAJAJFINSV: 'Bajaj Finserv',
            RELIANCE: 'Reliance Industries',
            HINDUNILVR: 'Hindustan Unilever',
            ITC: 'ITC Ltd',
            MARUTI: 'Maruti Suzuki',
            TATAMOTORS: 'Tata Motors',
            'M&M': 'Mahindra & Mahindra',
            SUNPHARMA: 'Sun Pharma',
            ONGC: 'Oil & Natural Gas Corp',
            TATASTEEL: 'Tata Steel',
            LT: 'Larsen & Toubro',
            TITAN: 'Titan Company'
        };

        // Seeded random function for consistent data (LCG algorithm)
        function seededRandom(symbol, index = 0) {
            let seed = 0;
            const str = symbol + index;
            for (let i = 0; i < str.length; i++) {
                seed = ((seed << 5) - seed) + str.charCodeAt(i);
                seed = seed & 0x7FFFFFFF; // Keep it positive 32-bit
            }
            // Linear Congruential Generator
            seed = (seed * 1103515245 + 12345) & 0x7FFFFFFF;
            return seed / 0x7FFFFFFF; // Return 0-1
        }

        // Generate mock stock data for Indian stocks
        function generateMockStock(symbol, sectorName) {
            const r = (idx) => seededRandom(symbol, idx);
            const basePrice = r(1) * 3000 + 100; // Indian stock price range
            const score = Math.floor(r(2) * 100);
            const rsi = r(3) * 100;
            const vix = r(4) * 30 + 10; // India VIX 10-40
            
            // Determine options recommendation
            const isBullish = score >= 60 || rsi < 35;
            const isBearish = score <= 40 || rsi > 65;
            const optionType = isBullish ? 'CALL' : isBearish ? 'PUT' : 'STRADDLE';
            const optionSentiment = isBullish ? 'BULLISH' : isBearish ? 'BEARISH' : 'NEUTRAL';
            const confidence = Math.floor(r(5) * 30 + 60); // 60-90%
            
            // Calculate strike prices
            const roundToStrike = (price) => Math.round(price / 50) * 50;
            const atm = roundToStrike(basePrice);
            const itm = optionType === 'CALL' ? roundToStrike(basePrice * 0.97) : roundToStrike(basePrice * 1.03);
            const otm = optionType === 'CALL' ? roundToStrike(basePrice * 1.03) : roundToStrike(basePrice * 0.97);
            
            return {
                symbol,
                name: STOCK_NAMES[symbol] || `${symbol} Ltd`,
                price: basePrice.toFixed(2),
                change: (r(6) * 50 - 25).toFixed(2),
                changePercent: ((r(7) * 10 - 5)).toFixed(2),
                sector: sectorName,
                score: score,
                peRatio: (r(8) * 50 + 10).toFixed(2),
                marketCap: `‚Çπ${(r(9) * 500 + 50).toFixed(0)}K Cr`,
                volume: `${(r(10) * 50 + 5).toFixed(1)}L`,
                recommendation: score >= 70 ? 'BUY' : score >= 40 ? 'HOLD' : 'SELL',
                rsi: rsi.toFixed(2),
                macd: (r(11) * 10 - 5).toFixed(2),
                ema50: (basePrice * (1 + (r(12) * 0.1 - 0.05))).toFixed(2),
                ema200: (basePrice * (1 + (r(13) * 0.2 - 0.1))).toFixed(2),
                dayHigh: (basePrice * 1.03).toFixed(2),
                dayLow: (basePrice * 0.97).toFixed(2),
                week52High: (basePrice * 1.25).toFixed(2),
                week52Low: (basePrice * 0.75).toFixed(2),
                dividendYield: (r(14) * 3).toFixed(2) + '%',
                bookValue: (basePrice * 0.8).toFixed(2),
                // Options data
                options: {
                    sentiment: optionSentiment,
                    optionType: optionType,
                    confidence: confidence,
                    vix: vix.toFixed(2),
                    vixLevel: vix < 15 ? 'Low' : vix < 25 ? 'Normal' : vix < 35 ? 'High' : 'Very High',
                    strikes: {
                        itm: itm,
                        atm: atm,
                        otm: otm,
                        recommended: confidence > 70 ? otm : atm
                    },
                    premiums: {
                        call_itm: Math.round(basePrice * 0.05),
                        call_atm: Math.round(basePrice * 0.03),
                        call_otm: Math.round(basePrice * 0.015),
                        put_itm: Math.round(basePrice * 0.05),
                        put_atm: Math.round(basePrice * 0.03),
                        put_otm: Math.round(basePrice * 0.015)
                    },
                    greeks: {
                        delta: (r(15) * 0.4 + 0.4).toFixed(2),
                        gamma: (r(16) * 0.05).toFixed(3),
                        theta: -(r(17) * 0.05).toFixed(2),
                        vega: (r(18) * 50 + 20).toFixed(2)
                    },
                    expiry: {
                        nearTerm: '30 Jan 2026',
                        monthly: '27 Feb 2026',
                        recommended: vix > 25 ? 'Near Term' : 'Monthly'
                    },
                    strategy: isBullish ? 'Long Call' : isBearish ? 'Long Put' : 'Long Straddle'
                }
            };
        }

        function App() {
            const [screen, setScreen] = useState('home');
            const [selectedSector, setSelectedSector] = useState(null);
            const [selectedStock, setSelectedStock] = useState(null);
            const [activeTab, setActiveTab] = useState('overview');
            const [loading, setLoading] = useState(false);
            const [stockData, setStockData] = useState({});
            const [stocks, setStocks] = useState([]);
            const [isLoadingStocks, setIsLoadingStocks] = useState(false);
            
            // Load stocks when sector changes
            useEffect(() => {
                console.log(`üîÑ useEffect triggered - screen: ${screen}, sector: ${selectedSector}`);
                if (screen === 'stockList' && selectedSector) {
                    async function loadStocks() {
                        console.log(`üöÄ Loading stocks for ${selectedSector}...`);
                        setIsLoadingStocks(true);
                        const symbols = SECTORS[selectedSector];
                        console.log(`üìã Symbols to fetch:`, symbols);
                        
                        const stockPromises = symbols.map(symbol => fetchRealStockData(symbol));
                        const results = await Promise.all(stockPromises);
                        console.log(`üìä API Results:`, results);
                        
                        const validStocks = results
                            .filter(s => s !== null)
                            .map(realData => {
                                console.log(`üîß Processing ${realData.symbol}...`);
                                // Merge real data with mock options data
                                const mockData = generateMockStock(realData.symbol, selectedSector);
                                const merged = {
                                    ...realData,
                                    name: STOCK_NAMES[realData.symbol] || `${realData.symbol} Ltd`,
                                    price: realData.currentPrice,
                                    sector: selectedSector,
                                    recommendation: realData.score >= 70 ? 'BUY' : realData.score >= 40 ? 'HOLD' : 'SELL',
                                    // Keep mock data for missing fields
                                    peRatio: mockData.peRatio,
                                    marketCap: mockData.marketCap,
                                    dividendYield: mockData.dividendYield,
                                    bookValue: mockData.bookValue,
                                    macd: mockData.macd,
                                    ema50: mockData.ema50,
                                    ema200: mockData.ema200,
                                    options: mockData.options
                                };
                                console.log(`‚úÖ Merged data for ${realData.symbol}:`, merged);
                                return merged;
                            })
                            .sort((a, b) => b.score - a.score);
                        
                        console.log(`üéâ Final stocks array:`, validStocks);
                        setStocks(validStocks);
                        setIsLoadingStocks(false);
                    }
                    
                    loadStocks();
                }
            }, [screen, selectedSector]);

            // Fetch real stock data from Yahoo Finance API
            async function fetchRealStockData(symbol) {
                console.log(`üîç Fetching data for ${symbol}...`);
                try {
                    const yahooSymbol = `${symbol}.NS`; // NSE stocks
                    // Use CORS proxy to bypass CORS restrictions
                    const corsProxy = 'https://corsproxy.io/?';
                    const apiUrl = `https://query1.finance.yahoo.com/v8/finance/chart/${yahooSymbol}?interval=1d&range=1y`;
                    console.log(`üì° API URL: ${corsProxy + encodeURIComponent(apiUrl)}`);
                    
                    const response = await fetch(corsProxy + encodeURIComponent(apiUrl));
                    console.log(`‚úÖ Response status: ${response.status}`);
                    
                    const data = await response.json();
                    console.log(`üì¶ Data received for ${symbol}:`, data);
                    
                    if (!data.chart || !data.chart.result || !data.chart.result[0]) {
                        console.error(`‚ùå Invalid data structure for ${symbol}`);
                        throw new Error('Invalid data');
                    }
                    
                    const result = data.chart.result[0];
                    const quote = result.indicators.quote[0];
                    const meta = result.meta;
                    
                    const currentPrice = meta.regularMarketPrice;
                    const previousClose = meta.chartPreviousClose;
                    const dayHigh = meta.regularMarketDayHigh;
                    const dayLow = meta.regularMarketDayLow;
                    const volume = meta.regularMarketVolume;
                    const fiftyTwoWeekHigh = meta.fiftyTwoWeekHigh;
                    const fiftyTwoWeekLow = meta.fiftyTwoWeekLow;
                    
                    console.log(`üí∞ ${symbol} Price: ‚Çπ${currentPrice}`);
                    
                    const change = currentPrice - previousClose;
                    const changePercent = (change / previousClose) * 100;
                    
                    // Calculate technical indicators from price data
                    const closes = quote.close.filter(p => p !== null);
                    const volumes = quote.volume.filter(v => v !== null);
                    
                    // Simple RSI calculation (14-period)
                    const rsi = calculateRSI(closes.slice(-14));
                    
                    // Score based on technical + fundamental
                    const score = calculateScore(currentPrice, previousClose, rsi, changePercent);
                    
                    const stockData = {
                        symbol,
                        currentPrice: currentPrice.toFixed(2),
                        change: change.toFixed(2),
                        changePercent: changePercent.toFixed(2),
                        dayHigh: dayHigh.toFixed(2),
                        dayLow: dayLow.toFixed(2),
                        volume: (volume / 100000).toFixed(1) + 'L',
                        week52High: fiftyTwoWeekHigh.toFixed(2),
                        week52Low: fiftyTwoWeekLow.toFixed(2),
                        rsi: rsi.toFixed(2),
                        score: score,
                        prices: closes.slice(-90) // Last 90 days for chart
                    };
                    
                    console.log(`‚úÖ Successfully processed ${symbol}:`, stockData);
                    return stockData;
                } catch (error) {
                    console.error(`‚ùå Error fetching ${symbol}:`, error);
                    return null;
                }
            }
            
            function calculateRSI(prices) {
                if (prices.length < 2) return 50;
                let gains = 0, losses = 0;
                for (let i = 1; i < prices.length; i++) {
                    const diff = prices[i] - prices[i - 1];
                    if (diff > 0) gains += diff;
                    else losses -= diff;
                }
                const avgGain = gains / prices.length;
                const avgLoss = losses / prices.length;
                if (avgLoss === 0) return 100;
                const rs = avgGain / avgLoss;
                return 100 - (100 / (1 + rs));
            }
            
            function calculateScore(current, previous, rsi, changePercent) {
                let score = 50; // Base score
                
                // Price momentum
                if (changePercent > 3) score += 20;
                else if (changePercent > 1) score += 10;
                else if (changePercent < -3) score -= 20;
                else if (changePercent < -1) score -= 10;
                
                // RSI
                if (rsi < 30) score += 15; // Oversold - good to buy
                else if (rsi > 70) score -= 15; // Overbought
                else if (rsi >= 40 && rsi <= 60) score += 5; // Neutral zone
                
                return Math.max(0, Math.min(100, Math.floor(score)));
            }

            const handleSectorClick = (sectorName) => {
                setSelectedSector(sectorName);
                setScreen('stockList');
            };

            const handleStockClick = (stock) => {
                setSelectedStock(stock);
                setScreen('stockDetail');
            };

            const handleBack = () => {
                if (screen === 'stockDetail') {
                    setScreen('stockList');
                } else {
                    setScreen('home');
                    setSelectedSector(null);
                }
            };

            if (screen === 'home') {
                return (
                    <div>
                        <div className="header">
                            <h1>üìà NSE Stock Analyzer</h1>
                            <p>AI-Powered Indian Market Analysis</p>
                        </div>
                        <div className="sectors">
                            {/* Options Trading Card - Top Priority */}
                            <div 
                                className="sector-card"
                                style={{ 
                                    borderLeftColor: '#FF6B35',
                                    background: 'linear-gradient(135deg, #fff5f2 0%, #ffe8e0 100%)'
                                }}
                                onClick={() => {
                                    setScreen('optionsTrading');
                                    setSelectedSector('Options Trading');
                                }}
                            >
                                <h3>üéØ Options Trading</h3>
                                <p>Sure-shot Call & Put recommendations</p>
                                <span className="stock-count" style={{ background: '#FF6B35', color: 'white' }}>
                                    Top 20 trades
                                </span>
                            </div>
                            
                            {Object.keys(SECTORS).map(sectorName => (
                                <div 
                                    key={sectorName}
                                    className="sector-card"
                                    style={{ borderLeftColor: SECTOR_COLORS[sectorName] }}
                                    onClick={() => handleSectorClick(sectorName)}
                                >
                                    <h3>{sectorName}</h3>
                                    <p>View top performing stocks</p>
                                    <span className="stock-count">{SECTORS[sectorName].length} stocks</span>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            }
            
            // Options Trading Screen - Dedicated section for Call/Put recommendations
            if (screen === 'optionsTrading') {
                // Generate top options recommendations across all stocks
                const allStocks = [];
                Object.keys(SECTORS).forEach(sectorName => {
                    SECTORS[sectorName].forEach(symbol => {
                        const stock = generateMockStock(symbol, sectorName);
                        allStocks.push(stock);
                    });
                });
                
                // Filter and rank best Call options (BULLISH sentiment)
                const topCalls = allStocks
                    .filter(s => s.options.optionType === 'CALL')
                    .sort((a, b) => b.options.confidence - a.options.confidence)
                    .slice(0, 10);
                
                // Filter and rank best Put options (BEARISH sentiment)
                const topPuts = allStocks
                    .filter(s => s.options.optionType === 'PUT')
                    .sort((a, b) => b.options.confidence - a.options.confidence)
                    .slice(0, 10);
                
                return (
                    <div>
                        <div className="header">
                            <h1>üéØ Options Trading</h1>
                            <p>Sure-shot Call & Put Recommendations</p>
                        </div>
                        <button className="back-button" onClick={handleBack}>
                            ‚Üê Back to Home
                        </button>
                        
                        <div className="stock-list">
                            {/* Call Options Section */}
                            <div style={{ 
                                background: 'linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%)',
                                padding: '15px',
                                borderRadius: '12px',
                                marginBottom: '20px',
                                border: '2px solid #4CAF50'
                            }}>
                                <h2 style={{ 
                                    fontSize: '20px', 
                                    color: '#2e7d32', 
                                    marginBottom: '5px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}>
                                    üü¢ Top Call Options
                                </h2>
                                <p style={{ fontSize: '13px', color: '#558b2f', marginBottom: '15px' }}>
                                    Buy when expecting price to go UP
                                </p>
                                
                                {topCalls.map((stock, index) => (
                                    <div 
                                        key={stock.symbol}
                                        className="options-trade-card"
                                        style={{ 
                                            background: 'white',
                                            borderRadius: '10px',
                                            padding: '15px',
                                            marginBottom: '12px',
                                            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                                            borderLeft: '4px solid #4CAF50'
                                        }}
                                    >
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '10px' }}>
                                            <div>
                                                <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#333' }}>
                                                    {stock.symbol}
                                                </div>
                                                <div style={{ fontSize: '13px', color: '#666' }}>
                                                    {stock.name}
                                                </div>
                                            </div>
                                            <div style={{ 
                                                background: '#4CAF50',
                                                color: 'white',
                                                padding: '6px 12px',
                                                borderRadius: '20px',
                                                fontSize: '13px',
                                                fontWeight: 'bold'
                                            }}>
                                                {stock.options.confidence}% Sure
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            display: 'grid',
                                            gridTemplateColumns: '1fr 1fr',
                                            gap: '10px',
                                            marginBottom: '12px'
                                        }}>
                                            <div>
                                                <div style={{ fontSize: '12px', color: '#666' }}>Current Price</div>
                                                <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#333' }}>
                                                    ‚Çπ{stock.price}
                                                </div>
                                            </div>
                                            <div>
                                                <div style={{ fontSize: '12px', color: '#666' }}>Strike Price</div>
                                                <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#333' }}>
                                                    ‚Çπ{stock.options.strikes.recommended}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            background: '#f8f9fa',
                                            padding: '12px',
                                            borderRadius: '8px',
                                            marginBottom: '10px'
                                        }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Entry (Premium):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#2e7d32' }}>
                                                    ‚Çπ{stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.call_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.call_atm
                                                        : stock.options.premiums.call_itm}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Target (2x):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#4CAF50' }}>
                                                    ‚Çπ{(parseFloat(stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.call_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.call_atm
                                                        : stock.options.premiums.call_itm) * 2).toFixed(2)}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Stop Loss (50%):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#d32f2f' }}>
                                                    ‚Çπ{(parseFloat(stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.call_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.call_atm
                                                        : stock.options.premiums.call_itm) * 0.5).toFixed(2)}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div style={{ fontSize: '12px', color: '#666', marginBottom: '8px' }}>
                                            üìÖ Expiry: {stock.options.expiry.recommended} | VIX: {stock.options.vix}
                                        </div>
                                        
                                        <div style={{ fontSize: '13px', color: '#2e7d32', fontWeight: '600' }}>
                                            üí° {stock.options.strategy}
                                        </div>
                                    </div>
                                ))}
                            </div>
                            
                            {/* Put Options Section */}
                            <div style={{ 
                                background: 'linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%)',
                                padding: '15px',
                                borderRadius: '12px',
                                marginBottom: '20px',
                                border: '2px solid #f44336'
                            }}>
                                <h2 style={{ 
                                    fontSize: '20px', 
                                    color: '#c62828', 
                                    marginBottom: '5px',
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '8px'
                                }}>
                                    üî¥ Top Put Options
                                </h2>
                                <p style={{ fontSize: '13px', color: '#d32f2f', marginBottom: '15px' }}>
                                    Buy when expecting price to go DOWN
                                </p>
                                
                                {topPuts.map((stock, index) => (
                                    <div 
                                        key={stock.symbol}
                                        className="options-trade-card"
                                        style={{ 
                                            background: 'white',
                                            borderRadius: '10px',
                                            padding: '15px',
                                            marginBottom: '12px',
                                            boxShadow: '0 2px 8px rgba(0,0,0,0.1)',
                                            borderLeft: '4px solid #f44336'
                                        }}
                                    >
                                        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'start', marginBottom: '10px' }}>
                                            <div>
                                                <div style={{ fontSize: '18px', fontWeight: 'bold', color: '#333' }}>
                                                    {stock.symbol}
                                                </div>
                                                <div style={{ fontSize: '13px', color: '#666' }}>
                                                    {stock.name}
                                                </div>
                                            </div>
                                            <div style={{ 
                                                background: '#f44336',
                                                color: 'white',
                                                padding: '6px 12px',
                                                borderRadius: '20px',
                                                fontSize: '13px',
                                                fontWeight: 'bold'
                                            }}>
                                                {stock.options.confidence}% Sure
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            display: 'grid',
                                            gridTemplateColumns: '1fr 1fr',
                                            gap: '10px',
                                            marginBottom: '12px'
                                        }}>
                                            <div>
                                                <div style={{ fontSize: '12px', color: '#666' }}>Current Price</div>
                                                <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#333' }}>
                                                    ‚Çπ{stock.price}
                                                </div>
                                            </div>
                                            <div>
                                                <div style={{ fontSize: '12px', color: '#666' }}>Strike Price</div>
                                                <div style={{ fontSize: '16px', fontWeight: 'bold', color: '#333' }}>
                                                    ‚Çπ{stock.options.strikes.recommended}
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            background: '#f8f9fa',
                                            padding: '12px',
                                            borderRadius: '8px',
                                            marginBottom: '10px'
                                        }}>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Entry (Premium):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#c62828' }}>
                                                    ‚Çπ{stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.put_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.put_atm
                                                        : stock.options.premiums.put_itm}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '8px' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Target (2x):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#4CAF50' }}>
                                                    ‚Çπ{(parseFloat(stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.put_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.put_atm
                                                        : stock.options.premiums.put_itm) * 2).toFixed(2)}
                                                </span>
                                            </div>
                                            <div style={{ display: 'flex', justifyContent: 'space-between' }}>
                                                <span style={{ fontSize: '13px', color: '#666' }}>Stop Loss (50%):</span>
                                                <span style={{ fontSize: '14px', fontWeight: 'bold', color: '#d32f2f' }}>
                                                    ‚Çπ{(parseFloat(stock.options.strikes.recommended === stock.options.strikes.otm 
                                                        ? stock.options.premiums.put_otm
                                                        : stock.options.strikes.recommended === stock.options.strikes.atm
                                                        ? stock.options.premiums.put_atm
                                                        : stock.options.premiums.put_itm) * 0.5).toFixed(2)}
                                                </span>
                                            </div>
                                        </div>
                                        
                                        <div style={{ fontSize: '12px', color: '#666', marginBottom: '8px' }}>
                                            üìÖ Expiry: {stock.options.expiry.recommended} | VIX: {stock.options.vix}
                                        </div>
                                        
                                        <div style={{ fontSize: '13px', color: '#c62828', fontWeight: '600' }}>
                                            üí° {stock.options.strategy}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </div>
                );
            }

            if (screen === 'stockList') {
                if (isLoadingStocks) {
                    return (
                        <div>
                            <div className="header">
                                <h1>{selectedSector}</h1>
                                <p>Loading real-time data...</p>
                            </div>
                            <div style={{ 
                                padding: '50px 20px',
                                textAlign: 'center',
                                fontSize: '16px',
                                color: '#666'
                            }}>
                                üìä Fetching live NSE prices...
                            </div>
                        </div>
                    );
                }

                return (
                    <div>
                        <div className="header">
                            <h1>{selectedSector}</h1>
                            <p>{stocks.length} stocks ranked by score ‚Ä¢ LIVE DATA</p>
                        </div>
                        <button className="back-button" onClick={handleBack}>
                            ‚Üê Back to Sectors
                        </button>
                        <div className="stock-list">
                            {stocks.map(stock => (
                                <div 
                                    key={stock.symbol}
                                    className="stock-item"
                                    onClick={() => handleStockClick(stock)}
                                >
                                    <div className="stock-header">
                                        <span className="stock-symbol">{stock.symbol}</span>
                                        <span className={`stock-score ${
                                            stock.score >= 70 ? 'score-high' : 
                                            stock.score >= 40 ? 'score-medium' : 'score-low'
                                        }`}>
                                            {stock.score}
                                        </span>
                                    </div>
                                    <div className="stock-name">{stock.name}</div>
                                    <div className="stock-price">
                                        ‚Çπ{stock.price} 
                                        <span style={{ 
                                            color: stock.change >= 0 ? '#22c55e' : '#ef4444',
                                            marginLeft: '10px'
                                        }}>
                                            {stock.change >= 0 ? '‚Üë' : '‚Üì'} ‚Çπ{Math.abs(stock.change)} ({stock.changePercent}%)
                                        </span>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                );
            }

            if (screen === 'stockDetail') {
                const opt = selectedStock.options;
                
                return (
                    <div>
                        <div className="header">
                            <h1>{selectedStock.symbol}</h1>
                            <p>{selectedStock.name}</p>
                        </div>
                        <button className="back-button" onClick={handleBack}>
                            ‚Üê Back to {selectedSector}
                        </button>
                        
                        {/* Tabs */}
                        <div className="tabs">
                            <div 
                                className={`tab ${activeTab === 'overview' ? 'active' : ''}`}
                                onClick={() => setActiveTab('overview')}
                            >
                                Overview
                            </div>
                            <div 
                                className={`tab ${activeTab === 'fundamentals' ? 'active' : ''}`}
                                onClick={() => setActiveTab('fundamentals')}
                            >
                                Fundamentals
                            </div>
                            <div 
                                className={`tab ${activeTab === 'technical' ? 'active' : ''}`}
                                onClick={() => setActiveTab('technical')}
                            >
                                Technical
                            </div>
                            <div 
                                className={`tab ${activeTab === 'options' ? 'active' : ''}`}
                                onClick={() => setActiveTab('options')}
                            >
                                Options <span className="options-badge">NEW</span>
                            </div>
                        </div>
                        
                        <div className="stock-detail">
                            <div className={`recommendation ${selectedStock.recommendation.toLowerCase()}`}>
                                {selectedStock.recommendation}
                            </div>
                            
                            {/* Overview Tab */}
                            {activeTab === 'overview' && (
                                <div className="detail-card">
                                    <h3 style={{ marginBottom: '15px', color: '#333' }}>Overview</h3>
                                    <div className="metric-row">
                                        <span className="metric-label">Current Price</span>
                                        <span className="metric-value">‚Çπ{selectedStock.price}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Overall Score</span>
                                        <span className="metric-value">{selectedStock.score}/100</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Market Cap</span>
                                        <span className="metric-value">{selectedStock.marketCap}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Volume</span>
                                        <span className="metric-value">{selectedStock.volume}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Day High</span>
                                        <span className="metric-value">‚Çπ{selectedStock.dayHigh}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Day Low</span>
                                        <span className="metric-value">‚Çπ{selectedStock.dayLow}</span>
                                    </div>
                                </div>
                            )}
                            
                            {/* Fundamentals Tab */}
                            {activeTab === 'fundamentals' && (
                                <div className="detail-card">
                                    <h3 style={{ marginBottom: '15px', color: '#333' }}>Fundamentals</h3>
                                    <div className="metric-row">
                                        <span className="metric-label">P/E Ratio</span>
                                        <span className="metric-value">{selectedStock.peRatio}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Book Value</span>
                                        <span className="metric-value">‚Çπ{selectedStock.bookValue}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">Dividend Yield</span>
                                        <span className="metric-value">{selectedStock.dividendYield}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">52W High</span>
                                        <span className="metric-value">‚Çπ{selectedStock.week52High}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">52W Low</span>
                                        <span className="metric-value">‚Çπ{selectedStock.week52Low}</span>
                                    </div>
                                </div>
                            )}

                            {/* Technical Tab */}
                            {activeTab === 'technical' && (
                                <div className="detail-card">
                                    <h3 style={{ marginBottom: '15px', color: '#333' }}>Technical Indicators</h3>
                                    <div className="metric-row">
                                        <span className="metric-label">RSI</span>
                                        <span className="metric-value">{selectedStock.rsi}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">MACD</span>
                                        <span className="metric-value">{selectedStock.macd}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">EMA (50)</span>
                                        <span className="metric-value">‚Çπ{selectedStock.ema50}</span>
                                    </div>
                                    <div className="metric-row">
                                        <span className="metric-label">EMA (200)</span>
                                        <span className="metric-value">‚Çπ{selectedStock.ema200}</span>
                                    </div>
                                </div>
                            )}
                            
                            {/* Options Tab - Ultra Simplified */}
                            {activeTab === 'options' && (
                                <>
                                    <div className={`options-header ${opt.sentiment.toLowerCase()}`}>
                                        <div style={{ fontSize: '28px', fontWeight: 'bold', marginBottom: '8px' }}>
                                            {opt.optionType === 'CALL' ? 'üìà BUY CALL' : 'üìâ BUY PUT'}
                                        </div>
                                        <div style={{ fontSize: '16px', opacity: 0.95' }}>
                                            Strike: ‚Çπ{opt.strikes.recommended}
                                        </div>
                                    </div>
                                    
                                    {/* Trading Plan - Simple 3 Boxes */}
                                    <div style={{ 
                                        display: 'grid', 
                                        gridTemplateColumns: '1fr 1fr 1fr',
                                        gap: '10px',
                                        padding: '15px',
                                        marginBottom: '10px'
                                    }}>
                                        <div style={{ 
                                            background: 'linear-gradient(135deg, #2196F3 0%, #1976d2 100%)',
                                            padding: '20px',
                                            borderRadius: '12px',
                                            textAlign: 'center',
                                            boxShadow: '0 4px 10px rgba(33,150,243,0.3)'
                                        }}>
                                            <div style={{ fontSize: '12px', color: 'rgba(255,255,255,0.9)', marginBottom: '8px', fontWeight: '600' }}>
                                                üí≥ ENTRY
                                            </div>
                                            <div style={{ fontSize: '24px', fontWeight: 'bold', color: 'white' }}>
                                                ‚Çπ{opt.optionType === 'CALL' 
                                                    ? (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.call_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.call_atm :
                                                       opt.premiums.call_itm)
                                                    : (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.put_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.put_atm :
                                                       opt.premiums.put_itm)}
                                            </div>
                                            <div style={{ fontSize: '11px', color: 'rgba(255,255,255,0.8)', marginTop: '5px' }}>
                                                Premium to pay
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            background: 'linear-gradient(135deg, #4CAF50 0%, #388e3c 100%)',
                                            padding: '20px',
                                            borderRadius: '12px',
                                            textAlign: 'center',
                                            boxShadow: '0 4px 10px rgba(76,175,80,0.3)'
                                        }}>
                                            <div style={{ fontSize: '12px', color: 'rgba(255,255,255,0.9)', marginBottom: '8px', fontWeight: '600' }}>
                                                üéØ TARGET
                                            </div>
                                            <div style={{ fontSize: '24px', fontWeight: 'bold', color: 'white' }}>
                                                ‚Çπ{(parseFloat(opt.optionType === 'CALL' 
                                                    ? (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.call_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.call_atm :
                                                       opt.premiums.call_itm)
                                                    : (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.put_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.put_atm :
                                                       opt.premiums.put_itm)) * 2).toFixed(0)}
                                            </div>
                                            <div style={{ fontSize: '11px', color: 'rgba(255,255,255,0.8)', marginTop: '5px' }}>
                                                Exit at 2x (100% profit)
                                            </div>
                                        </div>
                                        
                                        <div style={{ 
                                            background: 'linear-gradient(135deg, #f44336 0%, #d32f2f 100%)',
                                            padding: '20px',
                                            borderRadius: '12px',
                                            textAlign: 'center',
                                            boxShadow: '0 4px 10px rgba(244,67,54,0.3)'
                                        }}>
                                            <div style={{ fontSize: '12px', color: 'rgba(255,255,255,0.9)', marginBottom: '8px', fontWeight: '600' }}>
                                                üõë STOP LOSS
                                            </div>
                                            <div style={{ fontSize: '24px', fontWeight: 'bold', color: 'white' }}>
                                                ‚Çπ{(parseFloat(opt.optionType === 'CALL' 
                                                    ? (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.call_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.call_atm :
                                                       opt.premiums.call_itm)
                                                    : (opt.strikes.recommended === opt.strikes.otm ? opt.premiums.put_otm :
                                                       opt.strikes.recommended === opt.strikes.atm ? opt.premiums.put_atm :
                                                       opt.premiums.put_itm)) * 0.5).toFixed(0)}
                                            </div>
                                            <div style={{ fontSize: '11px', color: 'rgba(255,255,255,0.8)', marginTop: '5px' }}>
                                                Exit if 50% loss
                                            </div>
                                        </div>
                                    </div>
                                    
                                    {/* Expiry Info */}
                                    <div style={{ 
                                        background: 'white',
                                        padding: '15px',
                                        margin: '0 15px 15px',
                                        borderRadius: '10px',
                                        textAlign: 'center',
                                        boxShadow: '0 2px 8px rgba(0,0,0,0.08)'
                                    }}>
                                        <div style={{ fontSize: '14px', color: '#666', fontWeight: '600' }}>
                                            üìÖ Expiry: {opt.expiry.recommended}
                                        </div>
                                    </div>
                                    
                                    {/* Risk Warning */}
                                    <div style={{ 
                                        background: '#fff3cd',
                                        padding: '12px',
                                        margin: '0 15px',
                                        borderRadius: '8px',
                                        borderLeft: '4px solid #ff9800'
                                    }}>
                                        <div style={{ fontSize: '11px', color: '#856404', lineHeight: '1.5', textAlign: 'center' }}>
                                            ‚ö†Ô∏è High risk. Max loss = Premium paid. Not financial advice.
                                        </div>
                                    </div>
                                </>
                            )}
                        </div>
                    </div>
                );
            }

            return null;
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
